# xlsximpexp_ai
**You will find here the xlsximport and xlsxexport [SQLite extensions](https://sqlite.org/loadext.html) that allow direct importing and exporting of XLSX Excel 2007 files (a.k.a. Open Office XML)**

The code was mostly generated by AI, manually fixed to make it work. In order of less manual effort: Claude Opus, Copilot and Gemini.

### xlsximport - SQLite extension to import XLSX files
Uses the SQLite zipfile extension to read XLSX archives and expat for XML parsing.
Two SQL functions defined:
xlsx_import() creates one table for each sheet in the XLSX file, with table name
equal to sheet name, and column names equal to the values in the first row of
the sheet.
xlsx_import_version() returns the version string.

Usage:
```
SELECT xlsx_import('input_filename.xlsx');
SELECT xlsx_import_version();
```

### xlsxexport - SQLite extension to export XLSX files
Uses the either the SQLite zipfile extension or libxlsxwriter to write XLSX archives.
Two SQL functions defined:
xlsx_export() saves multiple tables as a single XLSX spreadsheet, 
with the sheet names equal to the table 
names, and the sheet headers in bold and with autofilter.
If the XLSX already exists, it will be overwritten without asking.
xlsx_import_version() returns the version string.

Usage:
```
SELECT xlsx_export('output_filename.xlsx', 'table1', 'table2', 'table3');
-- or with a single table:
SELECT xlsx_export('output_filename.xlsx', 'mytable');
SELECT xlsx_export_version();
```

### DEPENDENCIES:
The [SQLite Zipfile Module](https://sqlite.org/zipfile.html) is used to read and write the ZIP files.
Parsing XML is complicated so rely on a reputable library: xlsximport depends on [Expat](http://expat.sourceforge.net/).
Writing XML is easier so the xlsxexport extension in the copilot, gemini, opus folders do not use external libraries. Do not worry because the xlsxexport extension in folders copilot_libxlsxwriter and opus_libxlsxwriter depends on [libxlsxwriter](https://github.com/jmcnamara/libxlsxwriter).


### LICENSE:
* My xlsximport and xlsxexport code is Public Domain. Same as [SQLite](https://www.sqlite.org/). Notice though that [Expat](http://expat.sourceforge.net/) license is MIT, and [libxlsxwriter](https://github.com/jmcnamara/libxlsxwriter) license is FreeBSD.