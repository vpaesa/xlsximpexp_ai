# xlsximpexp_ai
**You will find here the xlsximport and xlsxexport [SQLite extensions](https://sqlite.org/loadext.html) that allow direct importing and exporting of XLSX Excel 2007 files (a.k.a. Open Office XML)**

The code was mostly generated by AI, and manually fixed to make it work. The LLMs used in order of less to more manual effort are:
1. Claude Opus 4.5 (Thinking)
2. Copilot Think Deeper (probably that means GPT 5.1)
3. Gemini 3 Pro (High).

Regardless of the LLM used, the extensions have the same API and same name, so that they can be freely interchanged. They are placed in different folders depending on the LLM or dependencies used:
| Folder | Content | Dependencies | LLM | Works? |
| -------- | ------- |------- |------- | ------- |
| opus  | xlsximport <br>xlsxexport | zipfile, expat <br>zipfile | Claude Opus 4.5 | Yes |
| opus_libxlsxwriter | xlsxexport | libxlsxwriter | Claude Opus 4.5 | Yes |
| copilot  | xlsximport <br>xlsxexport | zipfile, expat <br>zipfile | Copilot Think Deeper | Yes |
| copilot_libxlsxwriter | xlsxexport | libxlsxwriter | Copilot Think Deeper | Yes |
| gemini  | xlsximport <br>xlsxexport | zipfile, expat <br>zipfile | Gemini 3 Pro | Only xlsxexport |

### xlsximport - SQLite extension to import XLSX files
Uses the SQLite zipfile extension to read XLSX archives and expat for XML parsing.
Two SQL functions defined:
* `xlsx_import(path_to_xlsx)` creates one table for each sheet in the XLSX file, with table name
equal to sheet name, and column names equal to the values in the first row of
the sheet.
* `xlsx_import_version()` returns the version string.

Usage:
```
.load xlsximport
SELECT xlsx_import('input_filename.xlsx');
SELECT xlsx_import_version();
```

### xlsxexport - SQLite extension to export XLSX files
Uses the either the SQLite zipfile extension or libxlsxwriter to write XLSX archives.
Two SQL functions defined:
* `xlsx_export(path_to_xlsx, table1, table2, table3)` saves multiple tables as a single XLSX spreadsheet, 
with the sheet names equal to the table 
names, and the sheet headers in bold and with autofilter.
If the XLSX already exists, it will be overwritten without asking.
* `xlsx_export_version()` returns the version string.

Usage:
```
.load xlsxexport
SELECT xlsx_export('output_filename.xlsx', 'table1', 'table2', 'table3');
-- or with a single table:
SELECT xlsx_export('output_filename.xlsx', 'mytable');
SELECT xlsx_export_version();
```

### DEPENDENCIES:
The XLSX format is just a set of XML files packed into a ZIP container.

The [SQLite Zipfile Module](https://sqlite.org/zipfile.html) is used to read and write the ZIP container. This zipfile extension is included in most builds of the [SQLite command-line shell](https://sqlite.org/cli.html). 

Parsing XML is complicated so I decided best relying on a reputable library: xlsximport depends on [Expat](http://expat.sourceforge.net/).
Writing XML is easier so the xlsxexport extension in the copilot, gemini, opus folders do not use external libraries. Do not worry about reputability because the xlsxexport extension in folders copilot_libxlsxwriter and opus_libxlsxwriter depends on [libxlsxwriter](https://github.com/jmcnamara/libxlsxwriter).

Compilation depends on SQLite includes. One way to get them is
```
curl -C - --remote-name  https://sqlite.org/2025/sqlite-amalgamation-3510100.zip
unzip sqlite-amalgamation-3510100.zip
```

## LICENSE:
My xlsximport and xlsxexport code is Public Domain. Same as [SQLite](https://www.sqlite.org/). Notice though that [Expat](http://expat.sourceforge.net/) license is MIT, and [libxlsxwriter](https://github.com/jmcnamara/libxlsxwriter) license is FreeBSD.



